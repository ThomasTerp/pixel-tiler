(this["webpackJsonppixel-tiler"]=this["webpackJsonppixel-tiler"]||[]).push([[0],[,,,,,,,,,,,,,,function(t,e,o){},,function(t,e,o){},function(t,e,o){},function(t,e,o){},function(t,e,o){},function(t,e,o){},function(t,e,o){},function(t,e,o){},function(t,e,o){},function(t,e,o){"use strict";o.r(e);var n=o(5),i=o.n(n),r=o(9),s=o.n(r),a=o(1),c=o(2),l=o(4),u=o(3),h={dark:{color1:"#1a212d",color2:"#79c0ff",color3:"#1f2f46"},white:{color1:"#999999",color2:"#000000",color3:"#f2f2f2"}},p=i.a.createContext({theme:h.dark}),f=(o(14),o(0)),d=function(t){Object(l.a)(o,t);var e=Object(u.a)(o);function o(t){var n;return Object(a.a)(this,o),(n=e.call(this,t)).state={},n}return Object(c.a)(o,[{key:"render",value:function(){var t={backgroundColor:this.context.theme.color3};return this.props.isActive&&(t.borderColor=this.context.theme.color2),Object(f.jsx)("button",{className:"ToolButton ".concat(this.props.isActive?"Active":""),style:t,onClick:this.props.onClick,children:Object(f.jsx)("div",{style:{color:this.context.theme.color2},children:this.props.children})})}}]),o}(i.a.Component);d.contextType=p,d.defaultProps={};o(16);var v=function(t){Object(l.a)(o,t);var e=Object(u.a)(o);function o(){return Object(a.a)(this,o),e.apply(this,arguments)}return Object(c.a)(o,[{key:"render",value:function(){return Object(f.jsxs)("div",{className:"Tool",style:{backgroundColor:this.context.theme.color3},children:[Object(f.jsx)("h1",{className:"Name",style:{color:this.context.theme.color2},children:this.props.name}),this.renderProperties()]})}},{key:"renderProperties",value:function(){return Object(f.jsx)("div",{className:"Properties"})}}]),o}(i.a.Component);v.contextType=p;o(17);var m=function(t){Object(l.a)(o,t);var e=Object(u.a)(o);function o(t){var n;return Object(a.a)(this,o),(n=e.call(this,t))._inputRef=void 0,n._allowClick=!1,n._input_OnChange_SetPaletteColor=function(t){n.props.paletteManager.setColor(n.props.colorID,t.target.value)},n._input_OnClick_SelectColorID=function(t){n.props.isSelectable&&(n.props.paletteManager.selectedColorID=n.props.colorID,n._allowClick?n._allowClick=!1:t.preventDefault()),n.props.isEditable||(t.preventDefault(),t.preventDefault())},n._input_OnDoubleClick_OpenMenu=function(t){var e;n.props.isEditable&&n.props.isSelectable&&(n._allowClick=!0,null===(e=n._inputRef.current)||void 0===e||e.click())},n._input_OnContextMenu_OpenMenu=function(t){var e;n.props.isSelectable&&(n._allowClick=!0),null===(e=n._inputRef.current)||void 0===e||e.click(),t.preventDefault()},n.state={},n._inputRef=i.a.createRef(),n}return Object(c.a)(o,[{key:"render",value:function(){var t={};return this.props.isSelectable&&this.isSelected()&&(t.backgroundColor="".concat(this.context.theme.color2)),Object(f.jsx)("div",{className:"PaletteColor",style:t,children:Object(f.jsx)("input",{ref:this._inputRef,style:{backgroundColor:this.props.color,borderColor:this.context.theme.color1},type:"color",defaultValue:this.props.color,onChange:this._input_OnChange_SetPaletteColor,onClick:this._input_OnClick_SelectColorID,onDoubleClick:this._input_OnDoubleClick_OpenMenu,onContextMenu:this._input_OnContextMenu_OpenMenu})})}},{key:"isSelected",value:function(){return this.props.paletteManager.selectedColorID===this.props.colorID}}]),o}(i.a.Component);m.contextType=p,m.defaultProps={isEditable:!0,isSelectable:!0};o(18);var b=function(t){Object(l.a)(o,t);var e=Object(u.a)(o);function o(t){var n;return Object(a.a)(this,o),(n=e.call(this,t))._paletteAddColor_OnClick_AddColor=function(t){n.props.paletteManager.addColor()},n.state={},n}return Object(c.a)(o,[{key:"render",value:function(){return Object(f.jsx)("button",{className:"PaletteAddColor",style:{backgroundColor:this.context.theme.color1,borderColor:this.context.theme.color2},onClick:this._paletteAddColor_OnClick_AddColor,children:Object(f.jsx)("div",{style:{color:this.context.theme.color2},children:"+"})})}}]),o}(i.a.Component);b.contextType=p;o(19);var g=function(t){Object(l.a)(o,t);var e=Object(u.a)(o);function o(t){var n;return Object(a.a)(this,o),(n=e.call(this,t))._paletteManager_ColorChangeEmitter_ForceUpdate=function(t){n.forceUpdate()},n._paletteManager_SelectedColorIDChangeEmitter_ForceUpdate=function(t){n.forceUpdate()},n.state={},n}return Object(c.a)(o,[{key:"render",value:function(){var t=this;return Object(f.jsxs)("div",{className:"Palette",children:[this.props.paletteManager.colors.map((function(e,o){return Object(f.jsx)(m,{paletteManager:t.props.paletteManager,colorID:o,color:e,isEditable:t.props.isEditable,isSelectable:t.props.isSelectable},o)})),this.props.isEditable?Object(f.jsx)(b,{paletteManager:this.props.paletteManager}):null]})}},{key:"componentDidMount",value:function(){this.props.paletteManager.colorChangeEmitter.on(this._paletteManager_ColorChangeEmitter_ForceUpdate),this.props.paletteManager.selectedColorIDChangeEmitter.on(this._paletteManager_SelectedColorIDChangeEmitter_ForceUpdate)}},{key:"componentWillUnmount",value:function(){this.props.paletteManager.colorChangeEmitter.off(this._paletteManager_ColorChangeEmitter_ForceUpdate),this.props.paletteManager.selectedColorIDChangeEmitter.off(this._paletteManager_SelectedColorIDChangeEmitter_ForceUpdate)}}]),o}(i.a.Component);g.contextType=p,g.defaultProps={isEditable:!0,isSelectable:!0};var j=function(t){Object(l.a)(o,t);var e=Object(u.a)(o);function o(t){var n;return Object(a.a)(this,o),(n=e.call(this,t)).state={},n}return Object(c.a)(o,[{key:"renderProperties",value:function(){return Object(f.jsx)("div",{className:"Properties",children:Object(f.jsx)(g,{paletteManager:this.props.paletteManager,isEditable:!0,isSelectable:!1})})}}]),o}(v);j.defaultProps={name:"File"};var O=function(t){Object(l.a)(o,t);var e=Object(u.a)(o);function o(t){var n;return Object(a.a)(this,o),(n=e.call(this,t)).state={},n}return Object(c.a)(o,[{key:"renderProperties",value:function(){return Object(f.jsx)("div",{className:"Properties",children:Object(f.jsx)(g,{paletteManager:this.props.paletteManager})})}}]),o}(v);O.defaultProps={name:"Brush Tool"};var x=function(t){Object(l.a)(o,t);var e=Object(u.a)(o);function o(t){var n;return Object(a.a)(this,o),(n=e.call(this,t)).state={},n}return o}(v);x.defaultProps={name:"Eraser Tool"};var _=function(t){Object(l.a)(o,t);var e=Object(u.a)(o);function o(t){var n;return Object(a.a)(this,o),(n=e.call(this,t)).state={},n}return o}(v);_.defaultProps={name:"Settings"};o(20);var y=function(t){Object(l.a)(o,t);var e=Object(u.a)(o);function o(t){var n;return Object(a.a)(this,o),(n=e.call(this,t)).state={activeToolKey:"brushTool"},n}return Object(c.a)(o,[{key:"render",value:function(){var t=this,e=[Object(f.jsx)(j,{paletteManager:this.props.paletteManager},"fileTool"),Object(f.jsx)(O,{paletteManager:this.props.paletteManager},"brushTool"),Object(f.jsx)(x,{},"eraserTool"),Object(f.jsx)(_,{},"settingsTool")],o=e.map((function(e){return t.renderToolButton(e)})),n=e.find((function(e){return t.state.activeToolKey===e.key}));return Object(f.jsxs)("div",{className:"SideMenu",style:{backgroundColor:this.context.theme.color1},children:[Object(f.jsx)("div",{className:"ToolButtons",children:o}),n]})}},{key:"renderToolButton",value:function(t){var e=this,o=t.key,n=t.props.name;return Object(f.jsx)(d,{isActive:this.state.activeToolKey===o,onClick:function(){return e.setState({activeToolKey:o})},children:n},"".concat(o,"Button"))}}]),o}(i.a.Component);y.contextType=p,y.defaultProps={};var C=o(7),k=function(t){Object(l.a)(o,t);var e=Object(u.a)(o);function o(t){var n;return Object(a.a)(this,o),(n=e.call(this,t)).state={},n}return Object(c.a)(o,[{key:"render",value:function(){var t={transformOrigin:"".concat(this.props.size/2,"px ").concat(this.props.size/2,"px"),transform:"translate(".concat(this.props.position.x,"px, ").concat(this.props.position.y,"px) rotate(").concat(90*this.props.rotation,"deg)")};return Object(f.jsxs)("g",{className:"Tile",width:"".concat(this.props.size,"px"),height:"".concat(this.props.size,"px"),viewBox:"0,0 ".concat(this.props.size,",").concat(this.props.size),style:t,children:[this.props.svg,Object(f.jsx)("rect",{className:"TilePointer",x:"0",y:"0",width:"".concat(this.props.size,"px"),height:"".concat(this.props.size,"px"),fill:"none"})]})}}]),o}(i.a.Component);k.contextType=p;var w=function(t){Object(l.a)(o,t);var e=Object(u.a)(o);function o(t){var n;return Object(a.a)(this,o),(n=e.call(this,t)).state={},n}return Object(c.a)(o,[{key:"render",value:function(){return Object(f.jsx)("g",{className:"GridTiles",children:this.props.tiles})}}]),o}(i.a.Component);w.contextType=p,w.defaultProps={};var M=function(){function t(e,o){Object(a.a)(this,t),this.x=void 0,this.y=void 0,this.x=e,this.y=o}return Object(c.a)(t,[{key:"add",value:function(e){return"number"===typeof e?(this.x+=e,this.y+=e):e instanceof t&&(this.x+=e.x,this.y+=e.y),this}},{key:"subtract",value:function(e){return"number"===typeof e?(this.x-=e,this.y-=e):e instanceof t&&(this.x-=e.x,this.y-=e.y),this}},{key:"multiply",value:function(e){return"number"===typeof e?(this.x*=e,this.y*=e):e instanceof t&&(this.x*=e.x,this.y*=e.y),this}},{key:"divide",value:function(e){return"number"===typeof e?(this.x/=e,this.y/=e):e instanceof t&&(this.x/=e.x,this.y/=e.y),this}},{key:"equal",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"copy",value:function(){return new t(this.x,this.y)}}]),t}();var D={};o(21);var z=o(6),S=o.n(z),I=function(t){Object(l.a)(o,t);var e=Object(u.a)(o);function o(t){var n;Object(a.a)(this,o),(n=e.call(this,t))._svg=void 0,n._isDragging=!1,n._dragCursorOffset=new M(0,0),n._dragOffset=new M(0,0),n._tileKey=0,n._svg_OnMouseWheel_Zoom=function(t){if(t.ctrlKey){if(t.originalEvent.wheelDelta>0&&n.state.zoom>n.props.zoomMinimum||t.originalEvent.wheelDelta<0&&n.state.zoom<n.props.zoomMaximum){var e=S()(window),o=new M((t.offsetX-e.width()/2)*n.state.zoom*n.props.zoomOffsetMultiplier,(t.offsetY-e.height()/2)*n.state.zoom*n.props.zoomOffsetMultiplier);n.setState({offset:t.originalEvent.wheelDelta>0?n.state.offset.copy().subtract(o):n.state.offset.copy().add(o)})}n.addZoom(t.originalEvent.wheelDelta),t.preventDefault()}},n._svg_OnMouseDown_StartDragging=function(t){switch(t.button){case 1:n._dragOffset.x=n.state.offset.x,n._dragOffset.y=n.state.offset.y,n._dragCursorOffset.x=t.nativeEvent.offsetX,n._dragCursorOffset.y=t.nativeEvent.offsetY,n._isDragging=!0,t.preventDefault()}},n._document_OnMouseUp_StopDragging=function(t){n._isDragging=!1},n._svg_OnMouseMove_Drag=function(t){n._isDragging&&n.setState({offset:new M(n._dragOffset.x+(t.nativeEvent.offsetX-n._dragCursorOffset.x)*n.state.zoom,n._dragOffset.y+(t.nativeEvent.offsetY-n._dragCursorOffset.y)*n.state.zoom)})},n._document_OnKeyDown_Hotkeys=function(t){switch(t.key){case"ArrowLeft":n.setState({offset:new M(n.state.offset.x+n.props.offsetIncrement,n.state.offset.y)});break;case"ArrowUp":n.setState({offset:new M(n.state.offset.x,n.state.offset.y+n.props.offsetIncrement)});break;case"ArrowRight":n.setState({offset:new M(n.state.offset.x-n.props.offsetIncrement,n.state.offset.y)});break;case"ArrowDown":n.setState({offset:new M(n.state.offset.x,n.state.offset.y-n.props.offsetIncrement)});break;case"w":n.setState({gridSize:Math.min(2*n.state.gridSize,n.props.gridSizeMaximum)});break;case"s":n.setState({gridSize:Math.max(n.state.gridSize/2,n.props.gridSizeMinimum)});break;case"+":t.ctrlKey&&(n.addZoom(n.props.zoomIncrement),t.preventDefault());break;case"-":t.ctrlKey&&(n.addZoom(-n.props.zoomIncrement),t.preventDefault())}},n._window_Resize_SetSize=function(t){var e=S()(window);n.setState({size:new M(e.width(),e.height())})};var r,s=S()(window),c=new M(s.width(),s.height());return n.state={uniqueID:(r="grid",r in D||(D[r]=0),"".concat(r).concat(D[r]++)),gridSize:32,zoom:1,offset:new M(0,0),size:c,tiles:[],color1:"#202124",color2:"#303136"},n._svg=i.a.createRef(),window.$1=Object(C.a)(n),n}return Object(c.a)(o,[{key:"render",value:function(){var t=this.state.offset.copy().add(this.state.size.copy().divide(2).multiply(this.state.zoom)),e=this.state.size.copy().multiply(this.state.zoom);return Object(f.jsxs)("svg",{className:"Grid",ref:this._svg,xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMinYMin",width:"".concat(this.state.size.x,"px"),height:"".concat(this.state.size.y,"px"),viewBox:"".concat(-t.x,",").concat(-t.y," ").concat(e.x,",").concat(e.y),onMouseDown:this._svg_OnMouseDown_StartDragging,onMouseMove:this._svg_OnMouseMove_Drag,children:[this.renderDefs(),this.renderGrid(t,e),Object(f.jsx)(w,{tiles:this.state.tiles})]})}},{key:"renderDefs",value:function(){return Object(f.jsxs)("defs",{children:[Object(f.jsx)("pattern",{id:"".concat(this.state.uniqueID,"_pattern1"),width:this.state.gridSize,height:this.state.gridSize,patternUnits:"userSpaceOnUse",children:Object(f.jsx)("rect",{width:"".concat(this.state.gridSize,"px"),height:"".concat(this.state.gridSize,"px"),fill:"none",stroke:this.state.color1,strokeWidth:"1"})}),Object(f.jsxs)("pattern",{id:"".concat(this.state.uniqueID,"_pattern2"),width:"".concat(this.props.gridSizeMaximum,"px"),height:"".concat(this.props.gridSizeMaximum,"px"),patternUnits:"userSpaceOnUse",children:[Object(f.jsx)("rect",{width:"".concat(this.props.gridSizeMaximum,"px"),height:"".concat(this.props.gridSizeMaximum,"px"),fill:"url(#".concat(this.state.uniqueID,"_pattern1)")}),Object(f.jsx)("rect",{width:"".concat(this.props.gridSizeMaximum,"px"),height:"".concat(this.props.gridSizeMaximum,"px"),fill:"none",stroke:this.state.color1,strokeWidth:"3"})]})]})}},{key:"renderGrid",value:function(t,e){return Object(f.jsxs)("g",{children:[Object(f.jsx)("rect",{id:"".concat(this.state.uniqueID,"_rect1"),x:"".concat(-t.x,"px"),y:"".concat(-t.y,"px"),width:"100%",height:"100%",fill:"url(#".concat(this.state.uniqueID,"_pattern2)")}),Object(f.jsx)("line",{id:"".concat(this.state.uniqueID,"_line1"),x1:"".concat(-t.x,"px"),y1:"0",x2:"".concat(-t.x+e.x,"px"),y2:"0",stroke:this.state.color2,strokeWidth:"3"}),Object(f.jsx)("line",{id:"".concat(this.state.uniqueID,"_line2"),x1:"0",y1:"".concat(-t.y,"px"),x2:"0",y2:"".concat(-t.y+e.y,"px"),stroke:this.state.color2,strokeWidth:"3"})]})}},{key:"componentDidMount",value:function(){var t=S()(document),e=S()(window),o=S()(this._svg.current);t.on("mouseup",this._document_OnMouseUp_StopDragging),t.on("keydown",this._document_OnKeyDown_Hotkeys),e.on("resize",this._window_Resize_SetSize),o.on("mousewheel",this._svg_OnMouseWheel_Zoom)}},{key:"componentWillUnmount",value:function(){var t=S()(document),e=S()(window),o=S()(this._svg.current);t.off("mouseup",this._document_OnMouseUp_StopDragging),t.off("keydown",this._document_OnKeyDown_Hotkeys),e.off("resize",this._window_Resize_SetSize),o.off("mousewheel",this._svg_OnMouseWheel_Zoom)}},{key:"addZoom",value:function(t){var e,o,n;this.setState({zoom:(e=this.state.zoom-t*this.state.zoom*this.props.zoomMultiplier,o=this.props.zoomMinimum,n=this.props.zoomMaximum,Math.min(Math.max(e,o),n))})}},{key:"positionToGrid",value:function(t){return new M(Math.floor(t.x/this.state.gridSize),Math.floor(t.y/this.state.gridSize))}},{key:"gridToPosition",value:function(t){return t.copy().multiply(this.state.gridSize)}},{key:"placeTile",value:function(t,e,o,n,i,r){var s=Object(f.jsx)(k,{svg:t,position:e,size:o,rotation:n,color:i,colorIndex:r},this._tileKey++);return this.setState({tiles:this.state.tiles.concat(s)}),s}}]),o}(i.a.Component);I.contextType=p,I.defaultProps={offsetIncrement:32,zoomIncrement:120,zoomMultiplier:.002,zoomOffsetMultiplier:.24,zoomMinimum:.064,zoomMaximum:4,gridSizeMinimum:2,gridSizeMaximum:128};var T=function t(){Object(a.a)(this,t)},E=function(){function t(){Object(a.a)(this,t),this._callbacks=new Map}return Object(c.a)(t,[{key:"on",value:function(t){this._callbacks.set(t,!0)}},{key:"off",value:function(t){this._callbacks.delete(t)}},{key:"once",value:function(t){var e=this;this.on((function(o){t(o),e.off(t)}))}},{key:"emit",value:function(t){"undefined"===typeof t&&(t=new T);for(var e=t,o=0,n=Array.from(this._callbacks.keys());o<n.length;o++){(0,n[o])(e)}return e}}]),t}(),P=function(t){Object(l.a)(o,t);var e=Object(u.a)(o);function o(t,n){var i;return Object(a.a)(this,o),(i=e.call(this)).colorID=void 0,i.color=void 0,i.colorID=t,i.color=n,i}return o}(T),N=function(t){Object(l.a)(o,t);var e=Object(u.a)(o);function o(t){var n;return Object(a.a)(this,o),(n=e.call(this)).selectedColorID=void 0,n.selectedColorID=t,n}return o}(T),U=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(a.a)(this,t),this.colors=void 0,this.colorChangeEmitter=new E,this.selectedColorIDChangeEmitter=new E,this._selectedColorID=0,this._defaultColor="#ffffff",this.colors=e,0===this.colors.length&&this.addColor()}return Object(c.a)(t,[{key:"selectedColorID",get:function(){return this._selectedColorID},set:function(t){var e=this.selectedColorIDChangeEmitter.emit(new N(t));this._selectedColorID=e.selectedColorID}},{key:"selectedColor",get:function(){return this.colors[this.selectedColorID]}},{key:"addColor",value:function(){this.setColor(this.colors.length,this._defaultColor)}},{key:"setColor",value:function(t,e){var o=this.colorChangeEmitter.emit(new P(t,e));this.colors[o.colorID]=o.color}}]),t}(),A=(o(22),function(t){Object(l.a)(o,t);var e=Object(u.a)(o);function o(t){var n;return Object(a.a)(this,o),(n=e.call(this,t))._appContext=void 0,n.state={paletteManager:new U(n.props.defaultPaletteColors),selectedTileset:t.tilesets.default,selectedTile:t.tilesets.default.getTile("tile1")},n._appContext={theme:n.props.themes.dark},n}return Object(c.a)(o,[{key:"render",value:function(){return Object(f.jsx)(p.Provider,{value:this._appContext,children:Object(f.jsxs)("div",{className:"App",children:[this.renderContent(),Object(f.jsx)(y,{paletteManager:this.state.paletteManager})]})})}},{key:"renderContent",value:function(){return Object(f.jsx)("div",{className:"Content",children:Object(f.jsx)(I,{})})}}]),o}(i.a.Component)),K=function(t){t&&t instanceof Function&&o.e(3).then(o.bind(null,25)).then((function(e){var o=e.getCLS,n=e.getFID,i=e.getFCP,r=e.getLCP,s=e.getTTFB;o(t),n(t),i(t),r(t),s(t)}))},R=(o(23),{default:new(function(){function t(e){Object(a.a)(this,t),this.name=void 0,this._tiles=void 0,this.name=e,this._tiles={}}return Object(c.a)(t,[{key:"tiles",get:function(){return this._tiles}},{key:"setTile",value:function(t,e){this._tiles[t]=e}},{key:"getTile",value:function(t){return this._tiles[t]}}]),t}())("default")}),F=["#ffffff","#cccccc","#000000","#333333","#925c3a","#784f35","#dc6d1c","#f4dd42","#b23434","#631d1d","#81b93b","#4d893a","#5e81ca","#343d65","#cc00ff","#8f00b3","#ffb3ff"];s.a.render(Object(f.jsx)(i.a.StrictMode,{children:Object(f.jsx)(A,{themes:h,tilesets:R,defaultPaletteColors:F})}),document.getElementById("root")),K()}],[[24,1,2]]]);
//# sourceMappingURL=main.c90e039c.chunk.js.map